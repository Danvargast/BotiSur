<!-- index.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Botisur</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/custom.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body>
    <!-- Start Main Top -->
    <header class="main-header">
        <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-default bootsnav">
            <div class="container">
                <div class="navbar-header">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu">
                        <i class="fa fa-bars"></i>
                    </button>
                </div>
                <div class="collapse navbar-collapse" id="navbar-menu">
                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item active"><a class="nav-link" href="index.html">Inicio</a></li>
                        <li class="nav-item"><a class="nav-link" href="shop.html">Tienda</a></li>
                        <li class="nav-item"><a class="nav-link" href="recetas.html">Recetas</a></li>
                        <li class="nav-item"><a class="nav-link" href="contacto.html">Contacto</a></li>
                    </ul>
                </div>
                <div id="auth-container" class="login-box d-flex align-items-center ml-4">
                    <div id="logged-out-view" style="display: none;">
                        <a href="registro.html" class="btn btn-outline-primary mr-2">Registrarse</a>
                        <a href="login.html" class="btn btn-primary">Iniciar Sesión</a>
                    </div>
                    <div id="logged-in-view" style="display: none;">
                        <span id="user-greeting" class="mr-3 text-dark"></span>
                        <button id="logout-btn" class="btn btn-outline-danger">Cerrar Sesión</button>
                    </div>
                </div>
            </div>
        </nav>
    </header>
    <!-- End Main Top -->

    <!-- Start Slider -->
    <div id="slides-shop" class="cover-slides">
        <ul class="slides-container">
            <!-- ... (contenido de los slides) ... -->
        </ul>
    </div>
    <!-- End Slider -->
    
    <!-- Ofertas de la Semana -->
    <section class="products-box">
        <div class="container">
            <div class="title-all text-center">
                <h1>🔥 Ofertas de la Semana 🔥</h1>
            </div>
            <div id="ofertas-container" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                <!-- Las ofertas se cargarán aquí -->
            </div>
        </div>
    </section>

    <!-- Productos más vendidos -->
    <div class="products-box">
        <div class="container">
            <div class="title-all text-center">
                <h1>Nuestros productos más vendidos</h1>
                <p>Explora nuestra selección de cervezas, vinos y refrescos para cada ocasión.</p>
            </div>
            <div id="destacados-container" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                <!-- Los productos destacados se cargarán aquí -->
            </div>
        </div>
    </div>

    <!-- Start Footer  -->
    <footer>
        <div class="footer-main">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-top-box">
                            <h3>Horario de atención</h3>
                            <ul class="list-time">
                                <li>Lunes a Viernes: 08.00am a 05.00pm</li>
                                <li>Sábado: 10.00am a 08.00pm</li>
                                <li>Domingo: <span>Cerrado</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-top-box">
                            <h3>Subscríbete</h3>
                            <form class="newsletter-box">
                                <div class="form-group">
                                    <input class="" type="email" name="Email" placeholder="Dirección de correo*" />
                                    <i class="fa fa-envelope"></i>
                                </div>
                                <button class="btn hvr-hover" type="submit">Enviar</button>
                            </form>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 col-sm-12">
                        <div class="footer-top-box">
                            <h3>Redes sociales</h3>
                            <p>Síguenos en nuestras redes sociales.</p>
                            <ul>
                                <li><a href="#"><i class="fab fa-facebook" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fab fa-instagram" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fab fa-whatsapp" aria-hidden="true"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <hr>
            </div>
        </div>
    </footer>
    <!-- End Footer  -->

    <div class="footer-copyright">
        <p class="footer-company">Todos los derechos reservados. &copy; 2025 <a href="#">Botisur</a> </p>
    </div>

    <a href="#" id="back-to-top" title="Back to top" style="display: none;">&uarr;</a>

    <!-- ALL JS FILES -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.superslides.min.js"></script>
    <script src="js/bootsnav.js."></script>
    <script src="js/custom.js"></script>
    <script src="js/auth.js"></script>
    <script>
        const API_URL = 'http://127.0.0.1:8000';

        // Función para crear la tarjeta de un producto
        function createProductCard(producto) {
            const imageUrl = producto.imagen_url || `https://placehold.co/400x300/e8e8e8/666?text=${encodeURIComponent(producto.nombre)}`;
            const cardHtml = `
                <div class="col mb-5">
                    <div class="card h-100">
                        <img class="card-img-top" src="${imageUrl}" alt="${producto.nombre}" style="height: 200px; object-fit: cover;" onerror="this.onerror=null;this.src='https://placehold.co/400x300/e8e8e8/666?text=Imagen no disponible';"/>
                        <div class="card-body p-4 text-center">
                            <h5 class="fw-bolder">${producto.nombre}</h5>
                            $${parseFloat(producto.precio).toLocaleString('es-CL')}
                        </div>
                        <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                            <div class="text-center">
                                <a href="shop.html" class="btn btn-outline-dark mt-auto">Ver en tienda</a>
                            </div>
                        </div>
                    </div>
                </div>`;
            return cardHtml;
        }

        // Función para cargar los productos en una sección específica
        async function loadProducts(containerId, count) {
            const container = document.getElementById(containerId);
            container.innerHTML = '<div class="col-12 text-center"><p>Cargando...</p></div>';
            try {
                const response = await fetch(`${API_URL}/productos/`);
                if (!response.ok) throw new Error('Error de conexión');
                const productos = await response.json();
                
                container.innerHTML = '';
                // Tomamos solo los primeros 'count' productos
                const productosAMostrar = productos.slice(0, count);

                if (productosAMostrar.length === 0) {
                     container.innerHTML = '<div class="col-12 text-center"><p>No hay productos para mostrar.</p></div>';
                } else {
                    productosAMostrar.forEach(producto => {
                        container.innerHTML += createProductCard(producto);
                    });
                }
            } catch (error) {
                container.innerHTML = `<div class="col-12 text-center"><p>No se pudieron cargar los productos.</p></div>`;
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // Cargar 3 productos en la sección de ofertas
            loadProducts('ofertas-container', 3);
            // Cargar 3 productos en la sección de destacados
            loadProducts('destacados-container', 3);
        });
    </script>
</body>
</html>